<template>
  <div class="about">
    <h1>About Us</h1>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi condimentum mattis velit, sit
      amet aliquam sapien malesuada quis. Nulla suscipit ut eros quis faucibus. Sed maximus libero
      eu turpis convallis fringilla. Donec posuere nec enim a consectetur. Etiam blandit nisl velit,
      ac blandit nisi auctor ut. Curabitur tincidunt dui elit, sit amet molestie magna accumsan
      iaculis. Mauris eu nibh a neque tempus vestibulum ac eget erat. In nunc sapien, auctor in
      nulla eu, pretium sollicitudin turpis. Interdum et malesuada fames ac ante ipsum primis in
      faucibus.
    </p>
    <p>
      Nulla nisl enim, imperdiet et vulputate at, tempor eget nisl. Sed luctus urna urna, in
      tincidunt est molestie eget. Cras eu aliquam mi. Integer a diam sed ipsum luctus porta at sed
      erat. Aliquam ut gravida felis. Aenean felis ipsum, vulputate id diam vel, iaculis viverra
      magna. Nunc eleifend risus maximus, sodales leo ullamcorper, blandit felis. Pellentesque
      laoreet finibus sem at imperdiet. Proin interdum, tellus ac mollis pharetra, eros mi ultricies
      nulla, a ultrices quam arcu at felis. Sed elit libero, eleifend non nisl fringilla, placerat
      fermentum massa. Cras efficitur sed velit a vestibulum. Ut blandit cursus rhoncus. Morbi
      fringilla urna at leo rutrum sodales.
    </p>
    <p>
      Donec non erat sed lacus convallis sollicitudin egestas at sapien. Pellentesque ante augue,
      vestibulum at magna ut, interdum auctor mi. Quisque semper mattis purus at commodo. Fusce
      mattis sollicitudin tempor. Nam ut lectus sed arcu semper elementum. Curabitur ullamcorper
      pellentesque purus, sed consectetur urna eleifend dictum. Suspendisse eget dui fringilla,
      malesuada ligula nec, ullamcorper tellus. Suspendisse ornare eleifend ex nec ullamcorper. Nam
      convallis diam sit amet rutrum convallis.
    </p>
  </div>
  <div class="mission">
    <h1 id="misson">Our Mission</h1>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc volutpat scelerisque dui, sed
      facilisis nisi iaculis vitae. Mauris id justo aliquet, varius lectus at, congue nibh. Nam
      tincidunt lorem et egestas egestas. Nullam vel interdum tortor, vitae feugiat nisl. Mauris
      elementum tincidunt libero non dapibus. Proin aliquam nisl eu turpis interdum, eu viverra dui
      convallis. Cras vitae ligula tellus. Proin velit nisi, rhoncus quis vehicula mollis, pretium
      at arcu. Maecenas aliquet, quam in pharetra convallis, risus metus hendrerit felis, eget
      iaculis justo arcu a mi. Vivamus interdum nunc sed justo lobortis ullamcorper. In quis rhoncus
      sem, at hendrerit quam. Vestibulum ac lorem vitae nulla pulvinar hendrerit. Vivamus tempor
      sapien justo, eu feugiat sapien tincidunt id. Aliquam varius, arcu vitae sodales cursus, nisl
      elit cursus sapien, vel scelerisque velit neque quis felis.
    </p>
    <p>
      Nunc quis enim elementum, rhoncus metus aliquet, fringilla mauris. Sed porttitor nunc ante,
      eget mollis nibh hendrerit sodales. Praesent efficitur imperdiet ipsum. Mauris vel sapien
      volutpat, facilisis dolor quis, maximus eros. Curabitur sed enim vel velit volutpat luctus
      vitae sit amet urna. Vivamus cursus, magna et dapibus maximus, nisi odio elementum libero, at
      malesuada nunc dolor id purus. Maecenas sapien est, elementum vitae convallis vitae, dapibus
      non quam.
    </p>
  </div>
  <div class="team">
    <h1 id="team">Team</h1>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed sed elementum diam. Suspendisse
      dictum libero id erat sodales gravida. Nam posuere ex vel feugiat mollis. Nulla quis urna
      ultricies, aliquet odio quis, convallis neque. Duis tristique, lectus euismod dignissim
      ullamcorper, erat quam ultrices erat, in maximus arcu nisl maximus sem. Maecenas volutpat
      mollis efficitur. Vivamus in neque vel metus maximus maximus id sit amet libero.
    </p>
    <p>
      Aliquam ac elementum quam. Suspendisse potenti. Praesent tellus arcu, pulvinar ut massa sed,
      scelerisque cursus turpis. Sed lobortis eros nunc, nec aliquam turpis elementum ac. Mauris
      faucibus facilisis volutpat. In velit purus, rutrum vestibulum molestie.
    </p>
  </div>
  <div class="links">
    <h1 id="links">Partner Organisations</h1>
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed quis lacus ante. Mauris at arcu
      tincidunt, blandit diam vel, vehicula magna. Nullam faucibus orci at ipsum commodo, nec
      placerat massa consequat. Aliquam erat volutpat. Maecenas sit amet neque elementum, consequat
      mi nec, vulputate elit. In dictum iaculis sapien lobortis feugiat. Fusce justo sapien, gravida
      ut auctor non, posuere et sapien. Nullam lobortis metus in velit aliquet, sit amet aliquet ex
      gravida. Etiam euismod est eget ligula auctor tristique. Sed tempor tellus lacus, vitae
      vulputate nunc molestie sed. Ut in sem urna. Nulla eu sagittis purus. Curabitur vel nisl
      faucibus, efficitur nisl a, blandit elit. Quisque laoreet, est et tempor sagittis, augue magna
      porta lorem, at blandit ligula turpis id lacus.
    </p>
    <p>
      Proin maximus fermentum lectus, eget imperdiet est tempor quis. Vivamus auctor orci eu
      pellentesque venenatis. Aliquam a libero luctus, hendrerit quam vitae, placerat leo. Phasellus
      volutpat nisi maximus massa pulvinar.
    </p>
    <ul>
      <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</li>
      <li>Quisque efficitur, nunc ut facilisis tincidunt, enim ligula bibendum erat.</li>
      <li>Praesent nec ligula a nunc facilisis fringilla.</li>
      <li>Nulla facilisi. Sed nec ligula a nunc facilisis fringilla.</li>
      <li>Aliquam erat volutpat. Sed nec ligula a nunc facilisis fringilla.</li>
      <li>Donec nec ligula a nunc facilisis fringilla.</li>
      <li>In hac habitasse platea dictumst. Sed nec ligula a nunc facilisis fringilla.</li>
      <li>Curabitur nec ligula a nunc facilisis fringilla.</li>
    </ul>
  </div>
  <div class="contact my-5">
    <h1 id="contact" class="text-center my-5">Contact Us</h1>
    <div class="row">
      <div class="col-md-6">
        <div>
          <strong>Opening Hours</strong>
          <p>Monday to Friday: 9am - 5pm</p>
        </div>
        <div>
          <strong>Phone Number</strong>
          <p>+61 2 1234 5678</p>
        </div>
        <div>
          <strong>Address</strong>
          <p>123 High Street, Sydney, NSW 2000</p>
        </div>
        <div style="width: 100%">
          <iframe
            width="100%"
            height="330"
            frameborder="0"
            scrolling="no"
            marginheight="0"
            marginwidth="0"
            src="https://maps.google.com/maps?width=100%25&amp;height=330&amp;hl=en&amp;q=123%20High%20Street,%20Sydney,%20NSW%202000+()&amp;t=&amp;z=17&amp;ie=UTF8&amp;iwloc=B&amp;output=embed"
          ></iframe>
        </div>
      </div>
      <div class="row col-md-6">
        <p>
          <strong>
            Whether you want to volunteer, donate, inquire or just want to say hello, we would love
            to hear from you, send us a message.
          </strong>
        </p>
        <form @submit.prevent="submitForm" class="mb-5">
          <div class="row mb-3">
            <div class="col-6 col-md-6">
              <label for="firstname" class="form-label">First Name</label>
              <input
                type="text"
                class="form-control"
                id="firstname"
                @blur="() => validateName(true)"
                @input="() => validateName(false)"
                v-model="formData.firstname"
              />
              <div v-if="errors.firstname" class="text-danger">{{ errors.firstname }}</div>
            </div>
            <div class="col-6 col-md-6">
              <label for="surname" class="form-label">Surname</label>
              <input
                type="text"
                class="form-control"
                id="surname"
                @blur="() => validateName(true)"
                @input="() => validateName(false)"
                v-model="formData.surname"
              />
              <div v-if="errors.surname" class="text-danger">{{ errors.surname }}</div>
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-6 col-md-6">
              <label for="email" class="form-label">Email</label>
              <input
                type="text"
                class="form-control"
                id="email"
                @blur="() => validateEmail(true)"
                @input="() => validateEmail(false)"
                v-model="formData.email"
              />
              <div v-if="errors.email" class="text-danger">{{ errors.email }}</div>
            </div>
            <div class="col-6 col-md-6">
              <label for="phone" class="form-label">Phone</label>
              <input
                type="text"
                class="form-control"
                id="phone"
                @blur="() => validatePhone(true)"
                @input="() => validatePhone(false)"
                v-model="formData.phone"
              />
              <div v-if="errors.phone" class="text-danger">{{ errors.phone }}</div>
            </div>
          </div>
          <div class="col-6 col-md-6">
            <div class="subject">
              <label for="subject" class="form-label">Subject</label>
              <select
                class="form-select"
                id="subject"
                @blur="() => validateSubject(true)"
                @input="() => validateSubject(false)"
                v-model="formData.subject"
              >
                <option value="volunteer">Volunteer</option>
                <option value="donate">Donate</option>
                <option value="enquire">Enquire</option>
                <option value="general">General</option>
              </select>
              <div v-if="errors.subject" class="text-danger">{{ errors.subject }}</div>
            </div>
          </div>
          <div class="mb-3">
            <label for="userMessage" class="form-label">Message</label>
            <textarea
              class="form-control"
              id="userMessage"
              rows="7"
              @blur="() => validateMessage(true)"
              @input="() => validateMessage(false)"
              v-model="formData.usermessage"
            ></textarea>
            <div v-if="errors.usermessage" class="test-danger">
              {{ errors.usermessage }}
            </div>
          </div>
          <div class="text-center">
            <button type="submit" class="btn btn-primary me-2">Submit</button>
            <button type="button" class="btn btn-secondary" @click="clearForm">Clear</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue'
import db from '../firebase/init.js'
import { collection, addDoc } from 'firebase/firestore'

const formData = ref({
  firstname: '',
  surname: '',
  email: '',
  phone: '',
  subject: '',
  usermessage: '',
})

const submitForm = async () => {
  try {
    validateName(true)
    if (
      !errors.value.firstname &&
      !errors.value.surname &&
      !errors.value.email &&
      !errors.value.phone &&
      !errors.value.subject &&
      !errors.value.usermessage
    ) {
      await addDoc(collection(db, 'contact'), {
        firstname: formData.value.firstname,
        surname: formData.value.surname,
        email: formData.value.email,
        phone: formData.value.phone,
        subject: formData.value.subject,
        usermessage: formData.value.usermessage,
      })
      alert('Form submitted successfully!')
    }
  } catch (error) {
    console.error('Error submitting form:', error)
  } finally {
    formData.value = {
      firstname: '',
      surname: '',
      email: '',
      phone: '',
      subject: '',
      usermessage: '',
    }
    clearForm()
  }
}

const clearForm = () => {
  formData.value = {
    firstname: '',
    surname: '',
    email: '',
    phone: '',
    subject: '',
    usermessage: '',
  }
}

const errors = ref({
  firstname: null,
  surname: null,
  email: null,
  phone: null,
  subject: null,
  usermessage: null,
})

const validateName = (blur) => {
  if (formData.value.firstname.length < 3) {
    if (blur) errors.value.firstname = 'First name must be at least 3 characters'
  } else if (formData.value.surname.length < 3) {
    if (blur) errors.value.surname = 'Surname must be at least 3 characters'
  } else {
    errors.value.firstname = null
    errors.value.surname = null
  }
}

const validateSubject = (blur) => {
  if (formData.value.subject === '') {
    if (blur) errors.value.subject = 'Subject is required'
  } else {
    errors.value.usermessage = null
  }
}

const validateEmail = (blur) => {
  const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
  if (!emailPattern.test(formData.value.email)) {
    if (blur) errors.value.email = 'Not a vaild email address'
  } else {
    errors.value.email = null
  }
}

const validatePhone = (blur) => {
  const phonePattern = /^\d{10}$/
  if (!phonePattern.test(formData.value.phone)) {
    if (blur) errors.value.phone = 'Phone number must be 10 digits'
  } else {
    errors.value.phone = null
  }
}

const validateMessage = (blur) => {
  if (formData.value.usermessage.length < 10) {
    if (blur) errors.value.usermessage = 'Message must be at least 10 characters'
    else {
      errors.value.usermessage = null
    }
  }
}
</script>

<style scoped>
h1 {
  text-align: center;
}
</style>
